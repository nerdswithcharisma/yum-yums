var nwcApp=angular.module("nwcApp",[]).config(function($sceProvider){$sceProvider.enabled(!1)});nwcApp.controller("nwcCtrl",["$scope","$rootScope","$timeout","$window","nwcServices",function($scope,$rootScope,$timeout,$window,nwcServices){var self=this;$timeout(function(){nwcServices.renderReviewIcons(),self.doneLoading=!0},10),self.toggleRecipe=function(index){self.showRecipePanel=!self.showRecipePanel,self.mainItem=self.listView[index]},self.toggleMenu=function(){self.showNav=!self.showNav},nwcServices.getJSON("admin/api-r.php",function(data){self.listView=data}),self.loadItem=function(index){self.currentEntry=self.entries[index],self.currentEntryNumber=index},self.closeItem=function(){self.currentEntry=null},self.getItemInfo=function(index){self.mode="u",self.isUpdateListVisible=!1,self.currentEntry=self.entries[index],self.currentEntry.percentage=parseInt(10*parseInt(self.currentEntry.likes/self.currentEntry.sucks)),0===self.currentEntry.percentage&&(self.currentEntry.percentage=100),self.formData=self.entries[index],self.currentEntryBackground=self.currentEntry.image,self.currentEntryNumber=index},self.postItemInfo=function(title,likes,sucks,votes){votes=parseInt(votes)+1,likes=parseInt(likes)+1;var postData={title:title,likes:likes,sucks:sucks,votes:votes};nwcServices.postJSON("admin/api-rating-u.php",postData,function(data){nwcServices.getJSON("admin/api-r.php",function(data){self.listView=data,self.getItemInfo(self.currentEntryNumber)})})}}]),jQuery(window).load(function(){jQuery('[data-toggle="tooltip"]').tooltip()}),nwcApp.factory("nwcServices",function($http,$rootScope){return{getJSON:function(url,callback){$http({method:"GET",url:url,cache:!1,headers:{"Content-Type":"application/x-www-form-urlencoded","x-outlet-rest":"get","Cache-Control":"no-cache"}}).success(callback).error(callback)},postJSON:function(url,data,callback){$http({method:"POST",url:url,data:data,headers:{"Content-Type":"application/json"}}).success(callback).error(callback)},inputError:function(message,el){var position=jQuery(el).offset(),iTop=position.top-12,iLeft=position.left;jQuery("body").append('<div class="input--error bg--danger font--light padding-xs font-10 lh-xs" style="z-index: 9999; position: absolute; top: '+iTop+"px; left: "+iLeft+'px;" ><strong>'+message+"</strong></div>"),jQuery(document).mouseup(function(e){var container=$(".input--error");container.is(e.target)||0!==container.has(e.target).length||container.remove()})},displayErrorMessage:function(message){jQuery("#error").remove(),jQuery("body").append('<div id="error" class="alert alert-error">'+message+"</div>")},mqImages:function(){function mqSwitch(){switch(mq){case"xs":jQuery(".mqImage").each(function(){jQuery(this).attr("src",jQuery(this).attr("data-xs"))});break;case"sm":jQuery(".mqImage").each(function(){jQuery(this).attr("src",jQuery(this).attr("data-sm"))});break;case"md":jQuery(".mqImage").each(function(){jQuery(this).attr("src",jQuery(this).attr("data-md"))});break;case"lg":jQuery(".mqImage").each(function(){jQuery(this).attr("src",jQuery(this).attr("data-lg"))});break;case"xl":jQuery(".mqImage").each(function(){jQuery(this).attr("src",jQuery(this).attr("data-lg"))})}}mqSwitch(),jQuery(window).resize(function(){mqSwitch()})},hideLoadingMask:function($rootScope){$rootScope.loadingMask=!1},getHASH:function(){var URLhash=document.location.href.split("#");return URLhash[1]},geocode:function(location,callback){$http({method:"POST",url:"http://maps.googleapis.com/maps/api/geocode/json?address="+location+"&sensor=true",headers:{"Content-Type":"application/x-www-form-urlencoded"}}).success(callback).error(callback)},cut:function(word,n){return word=word.substring(0,n)+"..."},stripIt:function(word){return word=word.replace(/<(?:.|\n)*?>/gm,"")},renderReviewIcons:function(){jQuery(".font--review").each(function(){var reviewRating=parseFloat(jQuery(this).attr("data-rating"));switch(reviewRating){case.5:jQuery(this).find("i:lt(1)").addClass("fa-star-half-o").removeClass("fa-star-o");break;case 1:jQuery(this).find("i:lt(1)").addClass("fa-star").removeClass("fa-star-o");break;case 1.5:jQuery(this).find("i:lt(1)").addClass("fa-star").removeClass("fa-star-o"),jQuery(this).find("i:eq(1)").addClass("fa-star-half-o").removeClass("fa-star-o");break;case 2:jQuery(this).find("i:lt(2)").addClass("fa-star").removeClass("fa-star-o");break;case 2.5:jQuery(this).find("i:lt(2)").addClass("fa-star").removeClass("fa-star-o"),jQuery(this).find("i:eq(2)").addClass("fa-star-half-o").removeClass("fa-star-o");break;case 3:jQuery(this).find("i:lt(3)").addClass("fa-star").removeClass("fa-star-o");break;case 3.5:jQuery(this).find("i:lt(3)").addClass("fa-star").removeClass("fa-star-o"),jQuery(this).find("i:eq(3)").addClass("fa-star-half-o").removeClass("fa-star-o");break;case 4:jQuery(this).find("i:lt(4)").addClass("fa-star").removeClass("fa-star-o");break;case 4.5:jQuery(this).find("i:lt(4)").addClass("fa-star").removeClass("fa-star-o"),jQuery(this).find("i:eq(4)").addClass("fa-star-half-o").removeClass("fa-star-o");break;case 5:jQuery(this).find("i:lt(5)").addClass("fa-star").removeClass("fa-star-o")}})}}});